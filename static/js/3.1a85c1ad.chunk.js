(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{226:function(e,t,r){"use strict";r.d(t,"c",function(){return a}),r.d(t,"e",function(){return n}),r.d(t,"d",function(){return s}),r.d(t,"b",function(){return o}),r.d(t,"a",function(){return c});var a="https://shenzekun-qmusic-api.now.sh/",n="https://shenzekun-qmusic-api.now.sh/top",s="https://shenzekun-qmusic-api.now.sh/search",o="https://shenzekun-qmusic-api.now.sh/lyrics",c="https://shenzekun-qmusic-api.now.sh/hotkey"},227:function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.d(t,"a",function(){return a})},228:function(e,t,r){"use strict";function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function n(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}r.d(t,"a",function(){return n})},229:function(e,t,r){"use strict";function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r.d(t,"a",function(){return a})},230:function(e,t,r){"use strict";function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function n(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}r.d(t,"a",function(){return n})},231:function(e,t,r){"use strict";function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e){return(n="function"===typeof Symbol&&"symbol"===a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}var s=r(235);function o(e,t){return!t||"object"!==n(t)&&"function"!==typeof t?Object(s.a)(e):t}r.d(t,"a",function(){return o})},232:function(e,t,r){"use strict";r.d(t,"d",function(){return n}),r.d(t,"b",function(){return s}),r.d(t,"a",function(){return o}),r.d(t,"c",function(){return c});var a=r(226);function n(e){return"https://api.bzqll.com/music/tencent/url?key=579621905&id=".concat(e)}function s(e){return"".concat(a.b,"?id=").concat(e)}function o(e){return"https://y.gtimg.cn/music/photo_new/T002R150x150M000".concat(e,".jpg")}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return"".concat(a.d,"?keyword=").concat(e,"&page=").concat(t)}},234:function(e,t,r){"use strict";var a=r(246),n=r.n(a),s=r(248),o=r.n(s);n.a.defaults.headers.common["Content-Type"]="application/x-www-form-urlencoded";var c=n.a.create({timeout:3e4,transformRequest:[function(e){return o.a.stringify(e)}],headers:{"Content-Type":"application/x-www-form-urlencoded"}});c.interceptors.request.use(function(e){return e.data||(e.data={}),e.data.token="",e},function(e){return Promise.reject(e)}),c.interceptors.response.use(function(e){return e.data},function(e){if(e&&e.response)switch(e.response.status){case 400:e.message="\u9519\u8bef\u8bf7\u6c42";break;case 401:e.message="\u672a\u6388\u6743\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55";break;case 403:e.message="\u62d2\u7edd\u8bbf\u95ee";break;case 404:e.message="\u8bf7\u6c42\u9519\u8bef,\u672a\u627e\u5230\u8be5\u8d44\u6e90";break;case 405:e.message="\u8bf7\u6c42\u65b9\u6cd5\u672a\u5141\u8bb8";break;case 408:e.message="\u8bf7\u6c42\u8d85\u65f6";break;case 500:e.message="\u670d\u52a1\u5668\u7aef\u51fa\u9519";break;case 501:e.message="\u7f51\u7edc\u672a\u5b9e\u73b0";break;case 502:e.message="\u7f51\u7edc\u9519\u8bef";break;case 503:e.message="\u670d\u52a1\u4e0d\u53ef\u7528";break;case 504:e.message="\u7f51\u7edc\u8d85\u65f6";break;case 505:e.message="http\u7248\u672c\u4e0d\u652f\u6301\u8be5\u8bf7\u6c42";break;default:e.message="\u8fde\u63a5\u9519\u8bef".concat(e.response.status)}else e.message="\u8fde\u63a5\u5230\u670d\u52a1\u5668\u5931\u8d25";return Promise.resolve(e.response)});var i=c,u=r(226),l=r(232);r.d(t,"d",function(){return p}),r.d(t,"c",function(){return f}),r.d(t,"a",function(){return y}),r.d(t,"e",function(){return d}),r.d(t,"b",function(){return g});var p=function(){return i({url:u.c})},f=function(){return i({url:u.e})},y=function(){return i({url:u.a})},d=function(e,t){return i({url:Object(l.c)(e,t)})},g=function(e){return i({url:Object(l.b)(e)})}},235:function(e,t,r){"use strict";function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.d(t,"a",function(){return a})},236:function(e,t,r){"use strict";r.d(t,"a",function(){return a}),r.d(t,"b",function(){return n});var a=function(e){return"number"===typeof e&&e>1e4?(e/1e4).toFixed(1)+"\u4e07":e},n=function(e){var t=Math.floor(e/60),r=Math.floor(e%60);return t<10&&(t="0"+t),r<10&&(r="0"+r),"".concat(t,":").concat(r)}},251:function(e,t,r){"use strict";function a(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}r.d(t,"a",function(){return a})},284:function(e,t,r){e.exports={player:"player_player__1oe6v",player_container:"player_player_container__3ySOq",player_header:"player_player_header__25Oxv",album_cover:"player_album_cover__1o6qa",song_info:"player_song_info__2j-fY",song_name:"player_song_name__3VY63",song_artist:"player_song_artist__2S8Yu",icon_action:"player_icon_action__2F4Ey",icon_play:"player_icon_play__FdpZY",icon_pause:"player_icon_pause__2uRzj",player_lyrics:"player_player_lyrics__2tu5u",player_lyrics_list:"player_player_lyrics_list__14bnJ",player_lyrics_item:"player_player_lyrics_item__3nmZS",player_footer:"player_player_footer__s3r4B",icon_collect:"player_icon_collect__1gYaS",progress:"player_progress__2vDAp",progress_bar:"player_progress_bar__3VsNH",progress_bar_progress:"player_progress_bar_progress__3N72v",progress_time:"player_progress_time__sgxDZ",action:"player_action__GDjd_",btn_download:"player_btn_download__1d_Qz",player_background:"player_player_background__3BMqs"}},313:function(e,t,r){"use strict";r.r(t);var a=r(251),n=r(227),s=r(228),o=r(231),c=r(229),i=r(230),u=r(235),l=r(1),p=r.n(l),f=r(75),y=r(232),d=r(234),g=r(236),m=r(284),_=r.n(m),h=function(e){function t(){var e,r;Object(n.a)(this,t);for(var s=arguments.length,i=new Array(s),l=0;l<s;l++)i[l]=arguments[l];return(r=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).audioRef=null,r.playerLyricsListRef=null,r.progressRef=null,r.progressBarRef=null,r.state={isLoading:!1,duration:0,progress:0,elapsed:0,progressIntervalId:0,progressMoving:!1,progressBarWidth:0,startPageX:0,movePageX:0,lyrics:[],lyricIndex:0,LINE_HEIGHT:42,lyricIntervalId:0},r.getLyrics=function(){var e=r.props.song.songid;r.setState({isLoading:!0}),Object(d.b)(e).then(function(e){var t=e.lyric;t=r.formatText(t).match(/^\[\d{2}:\d{2}.\d{2}\](.+)$/gm),r.setState({lyricIndex:0,lyrics:Array.isArray(t)?Object(a.a)(t):[]})}).catch(function(e){console.error(e)}).then(function(){r.setState({isLoading:!1})})},r.onPlay=function(){var e=r.props,t=e.isPlay,a=e.setPlayState;if(t)try{r.audioRef.pause(),a(!1),r.pauseLyrics(),r.pauseProgress()}catch(n){}else{if(r.state.isLoading)return;try{r.audioRef.play(),a(!0),r.startLyrics(),r.startProgress()}catch(n){}}},r.handleOnAudioEnd=function(){try{r.audioRef.play(),r.restartLyrics(),r.resetProgress()}catch(e){}},r.startLyrics=function(){r.pauseLyrics(),r.setState({lyricIntervalId:setInterval(r.updateLyrics,1e3)})},r.pauseLyrics=function(){clearInterval(r.state.lyricIntervalId)},r.updateLyrics=function(){var e=Object(u.a)(Object(u.a)(r));try{if(r.audioRef.ontimeupdate=function(t){for(var r=0,a=e.state.lyrics.length;r<a;r++)e.audioRef.currentTime>e.getSeconds(e.state.lyrics[r])-.5&&(e.playerLyricsListRef.children[e.state.lyricIndex]&&e.playerLyricsListRef.children[e.state.lyricIndex].classList.remove("active"),e.playerLyricsListRef.children[r]&&e.playerLyricsListRef.children[r].classList.add("active"),e.setState({lyricIndex:r}))},r.state.lyricIndex>2){var t=-(r.state.lyricIndex-2)*r.state.LINE_HEIGHT;r.playerLyricsListRef.style.transform="translateY(".concat(t,"px)")}}catch(a){}},r.resetLyrics=function(){r.pauseLyrics(),r.playerLyricsListRef.children[r.state.lyricIndex]&&r.playerLyricsListRef.children[r.state.lyricIndex].classList.remove("active"),r.setState({lyricIndex:0}),r.playerLyricsListRef.style.transform="translateY(0)",r.state.lyrics.length&&r.playerLyricsListRef.children[0]&&r.playerLyricsListRef.children[0].classList.add("active")},r.restartLyrics=function(){r.resetLyrics(),r.startLyrics()},r.startProgress=function(){r.pauseProgress(),r.setState({progressIntervalId:setInterval(r.updateProgress,50)})},r.pauseProgress=function(){clearInterval(r.state.progressIntervalId)},r.updateProgress=function(){var e=r.state,t=e.elapsed,a=e.duration,n=t+.05;r.setState({elapsed:n,progress:n/a}),r.progressRef.style.transform="translateX(".concat(100*r.state.progress-100,"%)")},r.resetProgress=function(e){r.pauseProgress();var t={elapsed:0,progress:0};e&&(t.duration=+e),r.setState(t),r.progressRef.style.transform="translateX(-100%)"},r.restartProgress=function(){r.resetProgress(),r.startProgress()},r.progressTouchStart=function(e){r.setState({progressMoving:!0,startPageX:e.touches[0].pageX,startOffsetLeft:e.target.offsetLeft,progressBarWidth:r.progressBarRef.offsetWidth})},r.progressTouchMove=function(e){var t=e.touches[0].pageX,a=Math.min(r.state.progressBarWidth,Math.max(0,r.state.startOffsetLeft+(t-r.state.startPageX))),n=Math.floor(a/r.state.progressBarWidth*100)*r.state.duration/100;r.setState({movePageX:t,elapsed:n})},r.progressTouchEnd=function(e){r.setState({progressMoving:!1}),r.audioRef.currentTime=r.state.elapsed},r}return Object(i.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.song;this.setState({duration:e.interval}),this.getLyrics()}},{key:"componentWillUnmount",value:function(){try{var e=this.props.setPlayState;this.audioRef.pause(),e(!1),this.pauseLyrics(),this.pauseProgress()}catch(t){}}},{key:"getSeconds",value:function(e){return+e.replace(/^\[(\d{2}):(\d{2}\.\d{2}).*/,function(e,t,r){return 60*+t+parseFloat(+r)})}},{key:"formatText",value:function(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText}},{key:"getAlbumCover",value:function(e){return Object(y.a)(e)}},{key:"getSongUrl",value:function(e){return Object(y.d)(e)}},{key:"render",value:function(){var e=this,t=this.props,r=t.isShowPlayer,a=t.isPlay,n=t.song,s=t.artist,o=this.state,c=o.lyrics,i=void 0===c?[]:c,u=o.elapsed,f=o.isLoading;return p.a.createElement(l.Fragment,null,r&&p.a.createElement("div",{className:"".concat(_.a.player)},p.a.createElement("div",{className:_.a.player_container},p.a.createElement("div",{className:_.a.player_header},p.a.createElement("img",{className:_.a.album_cover,src:this.getAlbumCover(n.albummid),alt:n.songname}),p.a.createElement("div",{className:_.a.song_info},p.a.createElement("div",{className:_.a.song_name},n.songname),p.a.createElement("div",{className:_.a.song_artist},s)),p.a.createElement("i",{className:"".concat(_.a.icon_action," ").concat(_.a[a?"icon_pause":"icon_play"]),onClick:this.onPlay})),p.a.createElement("div",{className:_.a.player_lyrics},p.a.createElement("div",{className:_.a.player_lyrics_list,ref:function(t){return e.playerLyricsListRef=t}},i&&i.length>0&&i.map(function(e,t){return p.a.createElement("div",{className:_.a.player_lyrics_item,key:t},e.slice(10))}),f&&p.a.createElement("div",{className:_.a.player_lyrics_item},"\u6b63\u5728\u52a0\u8f7d\u6b4c\u8bcd,\u8bf7\u7b49\u5f85..."))),p.a.createElement("div",{className:_.a.player_footer},p.a.createElement("i",{className:_.a.icon_collect}),p.a.createElement("div",{className:_.a.progress},p.a.createElement("div",{className:"".concat(_.a.progress_time," ").concat(_.a.progress_elapsed)},Object(g.b)(u)),p.a.createElement("div",{className:_.a.progress_bar,ref:function(t){return e.progressBarRef=t}},p.a.createElement("div",{className:_.a.progress_bar_progress,ref:function(t){return e.progressRef=t},onTouchStart:this.progressTouchStart,onTouchMove:this.progressTouchMove,onTouchEnd:this.progressTouchEnd})),p.a.createElement("div",{className:"".concat(_.a.progress_time," ").concat(_.a.progress_duration)},Object(g.b)(n.interval))),p.a.createElement("div",{className:_.a.action},p.a.createElement("span",{className:_.a.btn_download},"\u4e0b\u8f7d\u8fd9\u9996\u6b4c")))),p.a.createElement("div",{className:_.a.player_background,style:{backgroundImage:"url("+this.getAlbumCover(n.albummid)+")"}}),p.a.createElement("audio",{src:this.getSongUrl(n.songmid),ref:function(t){return e.audioRef=t},onEnded:this.handleOnAudioEnd})))}}]),t}(l.PureComponent);t.default=Object(f.connect)(function(e,t){return{isShowPlayer:e.app.isShowPlayer,isPlay:e.app.isPlay,song:e.app.song,artist:e.app.artist}},function(e){return{getSong:function(t){e({type:"app/getSong",payload:t})},showPlayer:function(){e({type:"app/showPlayer"})},cancelPlayer:function(){e({type:"app/cancelPlayer"})},setPlayState:function(t){e({type:"app/setPlayState",payload:t})}}})(h)}}]);
//# sourceMappingURL=3.1a85c1ad.chunk.js.map